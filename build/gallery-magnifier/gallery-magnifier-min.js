YUI.add("gallery-magnifier",function(F){var B=function(H){this._image={};B.superclass.constructor.apply(this,arguments);},D="Magnifier",C="magnifier",E=F.ClassNameManager.getClassName(C,"display"),G=F.ClassNameManager.getClassName(C,"hidden"),A="<div><img /></div>";B.NAME=D;B.NS=D;B.ATTRS={host:{validator:function(H){if(!H.test("img")){F.fail(D+" can't be attached to this node.");return false;}return true;}},follow:{value:false,validator:F.Lang.isBoolean},display:{writeOnce:true,setter:function(H){H=F.one(H);return H;}},height:{value:100,validator:F.Lang.isNumber},width:{value:100,validator:F.Lang.isNumber},zoom:{value:2,validator:F.Lang.isNumber},staticX:{validator:F.Lang.isNumber},staticY:{validator:F.Lang.isNumber}};F.extend(B,F.Plugin.Base,{initializer:function(){var H=this.get("host"),I=this._image;I.width=parseInt(H.getStyle("width"),10);I.height=parseInt(H.getStyle("height"),10);I.left=H.getX();I.top=H.getY();I.right=I.left+I.width;I.bottom=I.top+I.height;this._renderDisplay();this.bindEvents();},bindEvents:function(){var I=this.get("host"),J=this.get("display"),H=this.get("follow");if(!H){this._MM=I.on("mousemove",this._moveViewport,this);this._MO=I.on("mouseout",function(){J.addClass(G);},this);this._ME=I.on("mouseover",function(){J.removeClass(G);},this);}else{this._ME=I.on("mouseover",function(){J.removeClass(G);this._MM=F.one("body").on("mousemove",this._moveViewport,this);},this);}},_renderDisplay:function(){var K=this.get("display"),H=this.get("height"),J=this.get("width"),I;if(!F.Lang.isValue(K)){K=F.Node.create("<div></div>");this.set("display",K);this.get("host").get("parentNode").append(K);}K.setContent(A);I=K.one("img");if(F.Lang.isValue(H)){K.setStyle("height",H);}if(F.Lang.isValue(J)){K.setStyle("width",J);}if(!this.get("follow")){K.setStyles({top:this.get("staticY"),left:this.get("staticX")});K.one("div").setStyle("position","relative");}else{K.setStyles({top:0,left:0});}K.setStyle("position","absolute");K.addClass(E);this._configureImage();K.addClass(G);},_configureImage:function(){var J=this.get("zoom"),L=this.get("display"),K=this.get("host"),I=L.one("img"),H=this.get("follow");I.set("src",K.get("src"));I.setStyles({height:this._image.height*J,width:this._image.width*J});if(H){I.setXY(K.getXY());}else{I.setStyles({top:this.get("staticY"),left:this.get("staticX")});}},_moveViewport:function(J){var I=this._image,R=this.get("zoom"),K=this.get("display"),M=K.one("div"),N=J.pageX-I.left,L=J.pageY-I.top,P=this.get("height")/2,O=this.get("width")/2,H=-N*R+P,Q=-L*R+O;if(J.pageX>=I.left&&J.pageX<=I.right&&J.pageY>=I.top&&J.pageY<=I.bottom){if(this.get("follow")){K.setStyles({top:J.pageY-P,left:J.pageX-O});}M.setStyles({left:H,top:Q});}else{K.addClass(G);this._MM.detach();}}});F.Magnifier=B;},"@VERSION@",{requires:["plugin","node","classnamemanager"]});